<!-- templates/generate_content.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Content</title>
</head>
<body>
    <h1>Generate Content</h1>
    <h2>Update Story</h2>
    <!-- Form to update story description -->
    <form id="update_form" action="/update_story" method="POST">
        <!-- Inputs to display story data and allow user to update description -->
        <div>
            <label for="story_title">Title:</label><br>
            <input type="text" id="story_title" name="story_title" value="" readonly><br>
        </div>
        <div>
            <label for="story_description">Description:</label><br>
            <textarea id="story_description" name="story_description" rows="4" cols="50"></textarea><br>
        </div>
        <div>
            <label for="story_category">Category:</label><br>
            <input type="text" id="story_category" name="story_category" value="" readonly><br>
        </div>
        <!-- Button to submit updated description -->
        <button type="submit">Update Description</button>
    </form>
    <!-- Button to return to story selection -->
    <button onclick="location.href='/update_story_select'">Back to Story Selection</button>

    <script>
        // Function to extract story ID from URL
        function getStoryIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('story_id');
        }

        // Function to fetch story data based on ID
        function fetchStoryData(storyId) {
            fetch(`/api/get_story?story_id=${storyId}`)
                .then(response => response.json())
                .then(data => {
                    // Populate fields with story data
                    document.getElementById('story_title').value = data.title;
                    document.getElementById('story_description').value = data.description;
                    document.getElementById('story_category').value = data.category;
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        // Function to be called when the page loads
        window.onload = function() {
            const storyId = getStoryIdFromUrl();
            if (storyId) {
                fetchStoryData(storyId);
            }
        };
    </script>
</body>
</html>
